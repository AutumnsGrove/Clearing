name = "clearing-api"
main = "worker/api/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

[env.production]
vars = { NODE_ENV = "production" }

[[d1_databases]]
binding = "DB"
database_name = "clearing-db"
database_id = "${CLOUDFLARE_D1_DATABASE_ID}"
preview_database_id = "${CLOUDFLARE_D1_DATABASE_ID}"

[site]
bucket = "./build"
entry-point = "."

[vars]
PUBLIC_SITE_URL = "https://status.grove.place"
PUBLIC_API_URL = "https://api.status.grove.place"

[triggers]
crons = ["*/5 * * * *"]  # Check for incident updates every 5 minutes